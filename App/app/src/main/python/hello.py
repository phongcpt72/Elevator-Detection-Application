import numpy as np
import matplotlib.pyplot as plt
x = [1004.4923008458749, 1004.5259010581592, 1004.56726554574, 1004.6138541117357, 1004.6627516213982, 1004.7091207701374, 1004.7144466091918, 1004.7607009295554, 1004.7657700414215, 1004.8114571290029, 1004.8166717509961, 1004.8638180537812, 1004.8688675260765, 1004.9144360070419, 1004.9195177186982, 1004.9651592263888, 1004.9701114884095, 1005.0152022061728, 1005.0203038555626, 1005.0672717630515, 1005.0726606311953, 1005.1203556535011, 1005.1254763839387, 1005.1720405184423, 1005.1773243187326, 1005.2232939223504, 1005.2283268006504, 1005.2736287520574, 1005.278555617553, 1005.3221714967741, 1005.3269207867272, 1005.369206913013, 1005.3739891233079, 1005.4180500989343, 1005.4229274068889, 1005.4663871967476, 1005.4712117290256, 1005.514924643079, 1005.5197092181834, 1005.5641306531409, 1005.5690632825235, 1005.6126544298246, 1005.6173672312701, 1005.6599003713834, 1005.7064915866005, 1005.7515877797711, 1005.7937356447159, 1005.8290251839712]
y = [1370, 1380, 1390, 1400, 1410, 1419, 1420, 1429, 1430, 1439, 1440, 1449, 1450, 1459, 1460, 1469, 1470, 1479, 1480, 1489, 1490, 1499, 1500, 1509, 1510, 1519, 1520, 1529, 1530, 1539, 1540, 1549, 1550, 1559, 1560, 1569, 1570, 1579, 1580, 1589, 1590, 1599, 1600, 1609, 1619, 1629, 1639, 1649]

# x = [2, 3, 5, 7, 9, 11, 14]
# y = [4, 5, 7, 10, 15, 20, 40]


X = np.array([x]).T
y = np.array([y]).T

# plt.plot(X, y, 'ro')
# #plt.axis([140, 190, 45, 75])
# plt.xlabel('Height (cm)')
# plt.ylabel('Weight (kg)')
# plt.show()
one = np.ones((X.shape[0], 1))
Xbar = np.concatenate((one, X), axis = 1)

# Calculating weights of the fitting line
A = np.dot(Xbar.T, Xbar)
b = np.dot(Xbar.T, y)
w = np.dot(np.linalg.pinv(A), b)
print('w = ', w)
# Preparing the fitting line
w_0 = w[0][0]
w_1 = w[1][0]
x0 = np.linspace(X[0], X[-1], 2)
y0 = w_0 + w_1*x0

# Drawing the fitting line
plt.plot(X.T, y.T, 'ro')     # data
plt.plot(x0, y0)               # the fitting line

plt.xlabel('Height (cm)')
plt.ylabel('Weight (kg)')
plt.show()